{"version":3,"sources":["../../../../src/utils/supabase/server.ts","../../../../src/app/examples/supabase/page.tsx"],"sourcesContent":["import { createServerClient } from '@supabase/ssr';\nimport { cookies } from 'next/headers';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseKey =\n  process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ??\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\ntype CookieStore = Awaited<ReturnType<typeof cookies>>;\n\nexport const createClient = async (cookieStore?: CookieStore) => {\n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error('Missing Supabase server credentials');\n  }\n\n  const store = cookieStore ?? (await cookies());\n\n  return createServerClient(supabaseUrl, supabaseKey, {\n    cookies: {\n      getAll() {\n        return store.getAll();\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) =>\n            store.set(name, value, options)\n          );\n        } catch {\n          // Server Components cannot mutate cookies; middleware should handle refresh.\n        }\n      },\n    },\n  });\n};\n","import { createClient } from '@/utils/supabase/server';\nimport { cookies } from 'next/headers';\n\nexport default async function Page() {\n  const cookieStore = await cookies();\n  const supabase = await createClient(cookieStore);\n\n  const { data: todos, error } = await supabase.from('todos').select('*');\n\n  if (error) {\n    throw error;\n  }\n\n  return (\n    <ul>\n      {todos?.map((todo, index) => (\n        <li key={(todo as { id?: string })?.id ?? index}>\n          {JSON.stringify(todo)}\n        </li>\n      ))}\n    </ul>\n  );\n}\n"],"names":[],"mappings":"wYAAA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MAEA,IAAM,EAAA,2CACA,EACJ,QAAQ,GAAG,CAAC,4CAA4C,EAAA,mNAK7C,EAAe,MAAO,IACjC,GAAI,CAAC,GAAe,CAAC,EACnB,MAAM,AAAI,KADsB,CAChB,uCAGlB,IAAM,EAAQ,GAAgB,MAAM,CAAA,EAAA,EAAA,OAAA,AAAO,IAE3C,MAAO,CAAA,EAAA,EAAA,kBAAA,AAAkB,EAAC,EAAa,EAAa,CAClD,QAAS,QACP,IACS,EAAM,MAAM,GAErB,OAAO,CAAY,EACjB,GAAI,CACF,EAAa,OAAO,CAAC,CAAC,MAAE,CAAI,OAAE,CAAK,SAAE,CAAO,CAAE,GAC5C,EAAM,GAAG,CAAC,EAAM,EAAO,GAE3B,CAAE,KAAM,CAER,CACF,CACF,CACF,EACF,EC9Be,eAAe,IAC5B,IAAM,EAAc,MAAM,CAAA,EAAA,EAAA,OAAA,AAAO,IAC3B,EAAW,MAAM,EAAa,GAE9B,CAAE,KAAM,CAAK,OAAE,CAAK,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,SAAS,MAAM,CAAC,KAEnE,GAAI,EACF,KADS,CACH,EAGR,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACE,GAAO,IAAI,CAAC,EAAM,IACjB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACE,KAAK,SAAS,CAAC,IADR,GAA0B,IAAM,KAMlD"}
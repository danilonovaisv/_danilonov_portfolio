{"version":3,"sources":["../../../../src/utils/supabase/server.ts","../../../../src/app/examples/supabase/page.tsx"],"sourcesContent":["import { createServerClient } from '@supabase/ssr';\nimport { cookies } from 'next/headers';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseKey =\n  process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY ??\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\ntype CookieStore = Awaited<ReturnType<typeof cookies>>;\n\nexport const createClient = async (cookieStore?: CookieStore) => {\n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error('Missing Supabase server credentials');\n  }\n\n  const store = cookieStore ?? (await cookies());\n\n  return createServerClient(supabaseUrl, supabaseKey, {\n    cookies: {\n      getAll() {\n        return store.getAll();\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) =>\n            store.set(name, value, options)\n          );\n        } catch {\n          // Server Components cannot mutate cookies; middleware should handle refresh.\n        }\n      },\n    },\n  });\n};\n","import { createClient } from '@/utils/supabase/server';\nimport { cookies } from 'next/headers';\n\nexport default async function Page() {\n  const cookieStore = await cookies();\n  const supabase = await createClient(cookieStore);\n\n  const { data: todos, error } = await supabase.from('todos').select('*');\n\n  if (error) {\n    throw error;\n  }\n\n  return (\n    <ul>\n      {todos?.map((todo, index) => (\n        <li key={(todo as { id?: string })?.id ?? index}>\n          {JSON.stringify(todo)}\n        </li>\n      ))}\n    </ul>\n  );\n}\n"],"names":[],"mappings":""}
{"version":3,"sources":["../../../../src/components/admin/TagForm.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useTransition } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { useForm, type Resolver, type SubmitHandler } from 'react-hook-form';\nimport { z } from 'zod';\n\nimport { createClientComponentClient } from '@/lib/supabase/client';\nimport type { DbTag } from '@/types/admin';\n\nconst tagSchema = z.object({\n  label: z.string().min(2),\n  slug: z.string().min(2),\n  kind: z.string().default('category'),\n  description: z.string().optional(),\n  sort_order: z.coerce.number().int().optional(),\n});\n\ntype Props = {\n  tag?: DbTag;\n  onSaved?: () => void;\n};\n\nexport function TagForm({ tag, onSaved }: Props) {\n  const [error, setError] = useState<string | null>(null);\n  const [isPending, startTransition] = useTransition();\n  const router = useRouter();\n\n  type FormValues = z.infer<typeof tagSchema>;\n\n  const form = useForm<FormValues>({\n    resolver: zodResolver(tagSchema) as Resolver<FormValues>,\n    defaultValues: {\n      label: tag?.label ?? '',\n      slug: tag?.slug ?? '',\n      kind: tag?.kind ?? 'category',\n      description: tag?.description ?? '',\n      sort_order: tag?.sort_order ?? undefined,\n    },\n  });\n\n  const onSubmit: SubmitHandler<FormValues> = (values) => {\n    setError(null);\n    startTransition(async () => {\n      try {\n        const supabase = createClientComponentClient();\n        const { error: upsertError } = await supabase\n          .from('portfolio_tags')\n          .upsert(\n            {\n              id: tag?.id,\n              ...values,\n            },\n            { onConflict: 'id' }\n          );\n\n        if (upsertError) throw upsertError;\n        router.refresh();\n        onSaved?.();\n      } catch (err) {\n        setError(\n          err instanceof Error ? err.message : 'Ocorreu um erro desconhecido'\n        );\n      }\n    });\n  };\n\n  return (\n    <form className=\"space-y-4\" onSubmit={form.handleSubmit(onSubmit)}>\n      <div className=\"grid gap-3 md:grid-cols-2\">\n        <label className=\"flex flex-col gap-1\">\n          <span className=\"text-sm text-slate-300\">Label</span>\n          <input\n            className=\"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm\"\n            {...form.register('label')}\n          />\n        </label>\n        <label className=\"flex flex-col gap-1\">\n          <span className=\"text-sm text-slate-300\">Slug</span>\n          <input\n            className=\"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm\"\n            {...form.register('slug')}\n          />\n        </label>\n        <label className=\"flex flex-col gap-1\">\n          <span className=\"text-sm text-slate-300\">Tipo</span>\n          <select\n            className=\"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm\"\n            {...form.register('kind')}\n          >\n            <option value=\"category\">Categoria</option>\n            <option value=\"discipline\">Disciplina</option>\n            <option value=\"industry\">Indústria</option>\n          </select>\n        </label>\n        <label className=\"flex flex-col gap-1\">\n          <span className=\"text-sm text-slate-300\">Ordem</span>\n          <input\n            type=\"number\"\n            className=\"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm\"\n            {...form.register('sort_order')}\n          />\n        </label>\n      </div>\n\n      <label className=\"flex flex-col gap-1\">\n        <span className=\"text-sm text-slate-300\">Descrição</span>\n        <textarea\n          rows={3}\n          className=\"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm\"\n          {...form.register('description')}\n        />\n      </label>\n\n      {error && <div className=\"text-sm text-red-400\">{error}</div>}\n\n      <button\n        type=\"submit\"\n        className=\"inline-flex items-center justify-center rounded-md bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow transition hover:bg-blue-600 disabled:opacity-50\"\n        disabled={isPending}\n      >\n        {isPending ? 'Salvando...' : 'Salvar tag'}\n      </button>\n    </form>\n  );\n}\n"],"names":[],"mappings":"kDAEA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA"}
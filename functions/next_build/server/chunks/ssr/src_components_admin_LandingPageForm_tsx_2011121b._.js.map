{"version":3,"sources":["../../../../src/components/admin/LandingPageForm.tsx","../../../../src/components/admin/blocks/MediaInput.tsx","../../../../src/components/admin/blocks/BlockEditor.tsx","../../../../src/components/ui/dropdown-menu.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { motion } from 'framer-motion';\nimport { createClientComponentClient } from '@/lib/supabase/client';\nimport { v4 as uuidv4 } from 'uuid';\nimport {\n  Trash2,\n  ChevronUp,\n  ChevronDown,\n  Save,\n  ArrowLeft,\n  Plus,\n  Layout,\n  ImageIcon,\n  Type,\n  Video,\n  Columns as ColumnsIcon,\n} from 'lucide-react';\nimport { uploadSiteAsset } from '@/lib/supabase/storage';\nimport Link from 'next/link';\nimport Image from 'next/image';\nimport { LandingPageBlock, BlockType } from '@/types/landing-page';\nimport { BlockEditor } from './blocks/BlockEditor';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\n\ninterface LandingPageFormProps {\n  initialData?: {\n    id: string;\n    title: string;\n    slug: string;\n    cover: string;\n    content: LandingPageBlock[];\n  };\n}\n\nexport default function LandingPageForm({ initialData }: LandingPageFormProps) {\n  const router = useRouter();\n  const supabase = createClientComponentClient();\n\n  const [title, setTitle] = useState(initialData?.title || '');\n  const [slug, setSlug] = useState(initialData?.slug || '');\n  const [cover, setCover] = useState<File | null>(null);\n  const [coverPreview, setCoverPreview] = useState(\n    initialData?.cover\n      ? `${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/site-assets/${initialData.cover}`\n      : ''\n  );\n\n  // Map initial content to our strictly typed blocks\n  const [sections, setSections] = useState<LandingPageBlock[]>(\n    (initialData?.content as LandingPageBlock[])?.map((s) => ({\n      ...s,\n      id: s.id || uuidv4(),\n      // Ensure content object structure\n      content: {\n        ...s.content,\n        // Hydrate full URLs for simple single-media existing blocks if needed\n        media: s.content.media?.startsWith('http')\n          ? s.content.media\n          : s.content.media\n            ? `${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/site-assets/${s.content.media}`\n            : undefined,\n        media2: s.content.media2?.startsWith('http')\n          ? s.content.media2\n          : s.content.media2\n            ? `${process.env.NEXT_PUBLIC_SUPABASE_URL}/storage/v1/object/public/site-assets/${s.content.media2}`\n            : undefined,\n      },\n    })) || []\n  );\n\n  const [loading, setLoading] = useState(false);\n\n  const handleAddBlock = (type: BlockType) => {\n    setSections([\n      ...sections,\n      {\n        id: uuidv4(),\n        type,\n        content: {}, // Empty content init\n        file: null,\n        file2: null,\n      },\n    ]);\n  };\n\n  const handleRemoveSection = (id: string) => {\n    if (confirm('Tem certeza que deseja remover este bloco?')) {\n      setSections(sections.filter((s) => s.id !== id));\n    }\n  };\n\n  const moveSection = (index: number, direction: 'up' | 'down') => {\n    const newSections = [...sections];\n    const newIndex = direction === 'up' ? index - 1 : index + 1;\n    if (newIndex < 0 || newIndex >= sections.length) return;\n    [newSections[index], newSections[newIndex]] = [\n      newSections[newIndex],\n      newSections[index],\n    ];\n    setSections(newSections);\n  };\n\n  const updateBlock = (id: string, updates: Partial<LandingPageBlock>) => {\n    setSections(sections.map((s) => (s.id === id ? { ...s, ...updates } : s)));\n  };\n\n  const handleFileUpload = async (file: File, key: string) => {\n    const path = await uploadSiteAsset({\n      file,\n      key,\n      page: 'landing-pages', // Shared bucket folder\n      subPath: slug || 'general',\n      bucket: 'site-assets',\n    });\n    return path;\n  };\n\n  const handleSave = async () => {\n    if (!title || !slug) {\n      alert('Título e Slug são obrigatórios.');\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      // Upload Cover\n      let coverPath = initialData?.cover || '';\n      if (cover) {\n        const path = await handleFileUpload(cover, `cover-${uuidv4()}`);\n        if (path) coverPath = path;\n      }\n\n      // Upload Block Assets\n      const uploadedSections = await Promise.all(\n        sections.map(async (section) => {\n          let mediaPath = section.content.media;\n          let media2Path = section.content.media2;\n\n          // Process File 1\n          if (section.file) {\n            const path = await handleFileUpload(\n              section.file,\n              `block-${section.id}-media1`\n            );\n            if (path) mediaPath = path;\n          } else if (mediaPath && mediaPath.includes('/site-assets/')) {\n            // Strip full URL to save relative path\n            mediaPath = mediaPath.split('/site-assets/').pop() || '';\n          }\n\n          // Process File 2\n          if (section.file2) {\n            const path = await handleFileUpload(\n              section.file2,\n              `block-${section.id}-media2`\n            );\n            if (path) media2Path = path;\n          } else if (media2Path && media2Path.includes('/site-assets/')) {\n            media2Path = media2Path.split('/site-assets/').pop() || '';\n          }\n\n          // Return clean object for DB\n          return {\n            id: section.id,\n            type: section.type,\n            content: {\n              ...section.content,\n              media: mediaPath,\n              media2: media2Path,\n            },\n          };\n        })\n      );\n\n      const payload = {\n        title,\n        slug,\n        cover: coverPath,\n        content: uploadedSections,\n      };\n\n      if (initialData?.id) {\n        const { error } = await supabase\n          .from('landing_pages')\n          .update(payload)\n          .eq('id', initialData.id);\n        if (error) throw error;\n      } else {\n        const { error } = await supabase\n          .from('landing_pages')\n          .insert({ ...payload, created_at: new Date().toISOString() });\n        if (error) throw error;\n      }\n\n      router.push('/admin/landing-pages');\n      router.refresh();\n    } catch (err: unknown) {\n      const errorMessage =\n        err instanceof Error ? err.message : 'Erro desconhecido';\n      console.error(err);\n      alert(`Erro ao salvar página: ${errorMessage}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"max-w-5xl mx-auto space-y-12 pb-48\">\n      {/* Header Actions */}\n      <div className=\"sticky top-4 z-50 bg-black/50 backdrop-blur-md p-4 rounded-full border border-white/10 flex items-center justify-between shadow-2xl\">\n        <Link\n          href=\"/admin/landing-pages\"\n          className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors px-4\"\n        >\n          <ArrowLeft size={20} />\n          <span className=\"hidden sm:inline\">Voltar</span>\n        </Link>\n        <div className=\"flex items-center gap-4\">\n          <span className=\"text-slate-500 text-sm hidden lg:inline\">\n            {sections.length} blocos adicionados\n          </span>\n          <button\n            onClick={handleSave}\n            disabled={loading}\n            className=\"flex items-center gap-2 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 px-8 py-2.5 rounded-full font-bold transition-all shadow-lg shadow-blue-600/20 text-sm tracking-wide\"\n          >\n            <Save size={18} />\n            {loading ? 'PUBLICANDO...' : 'SALVAR PÁGINA'}\n          </button>\n        </div>\n      </div>\n\n      {/* Main Form */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        {/* Left Column: Metadata & Global Settings */}\n        <div className=\"space-y-6 lg:col-span-1\">\n          <div className=\"bg-slate-900/40 border border-white/5 rounded-3xl p-6 space-y-6 sticky top-28\">\n            <h2 className=\"text-xs uppercase tracking-[0.2em] text-blue-400 font-bold mb-4\">\n              Configurações\n            </h2>\n\n            <div className=\"space-y-2\">\n              <label className=\"text-[10px] uppercase tracking-widest text-slate-500 font-bold\">\n                Título\n              </label>\n              <input\n                type=\"text\"\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n                className=\"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-3 text-lg font-medium focus:border-blue-500 outline-none\"\n                placeholder=\"Nome do Projeto\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"text-[10px] uppercase tracking-widest text-slate-500 font-bold\">\n                Slug URL\n              </label>\n              <div className=\"flex items-center gap-1 text-slate-500 bg-slate-950 border border-white/10 rounded-xl px-3 py-2\">\n                <span className=\"text-xs\">/projects/</span>\n                <input\n                  type=\"text\"\n                  value={slug}\n                  onChange={(e) =>\n                    setSlug(\n                      e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, '-')\n                    )\n                  }\n                  className=\"bg-transparent border-none outline-none text-white text-sm w-full font-mono\"\n                  placeholder=\"my-project\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-3 pt-4 border-t border-white/5\">\n              <label className=\"text-[10px] uppercase tracking-widest text-slate-500 font-bold flex items-center gap-2\">\n                Header Hero Image{' '}\n                <span className=\"text-blue-500 text-[10px]\">(Cover)</span>\n              </label>\n              <div className=\"relative group aspect-4/3 rounded-xl overflow-hidden bg-slate-950 border border-white/10\">\n                {coverPreview ? (\n                  <>\n                    <Image\n                      src={coverPreview}\n                      alt=\"Cover\"\n                      fill\n                      className=\"object-cover\"\n                    />\n                    <button\n                      onClick={() => {\n                        setCover(null);\n                        setCoverPreview('');\n                      }}\n                      className=\"absolute top-2 right-2 bg-red-600 p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity\"\n                      title=\"Remover Capa\"\n                      aria-label=\"Remover Capa\"\n                    >\n                      <Trash2 size={16} />\n                    </button>\n                  </>\n                ) : (\n                  <label className=\"absolute inset-0 flex flex-col items-center justify-center cursor-pointer hover:bg-white/5 transition-colors\">\n                    <ImageIcon className=\"text-slate-600 mb-2\" />\n                    <span className=\"text-[10px] text-slate-500\">\n                      Upload Capa\n                    </span>\n                    <input\n                      type=\"file\"\n                      className=\"hidden\"\n                      accept=\"image/*\"\n                      onChange={(e) => {\n                        const f = e.target.files?.[0];\n                        if (f) {\n                          setCover(f);\n                          setCoverPreview(URL.createObjectURL(f));\n                        }\n                      }}\n                    />\n                  </label>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Right Column: Page Builder */}\n        <div className=\"lg:col-span-2 space-y-8\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xs uppercase tracking-[0.2em] text-white font-bold\">\n              Builder\n            </h2>\n\n            {/* Add Block Dropdown */}\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <button className=\"flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-full text-xs font-bold uppercase tracking-wide transition-all shadow-lg hover:shadow-blue-500/25\">\n                  <Plus size={16} /> Adicionar Bloco\n                </button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent\n                align=\"end\"\n                className=\"w-56 bg-slate-900 border-slate-800 text-slate-200\"\n              >\n                <DropdownMenuLabel className=\"text-xs uppercase tracking-widest text-slate-500\">\n                  Layouts Básicos\n                </DropdownMenuLabel>\n                <DropdownMenuItem onClick={() => handleAddBlock('text')}>\n                  <Type className=\"mr-2 h-4 w-4\" /> Texto Puro\n                </DropdownMenuItem>\n                <DropdownMenuItem onClick={() => handleAddBlock('image')}>\n                  <ImageIcon className=\"mr-2 h-4 w-4\" /> Imagem Full\n                </DropdownMenuItem>\n                <DropdownMenuItem onClick={() => handleAddBlock('video')}>\n                  <Video className=\"mr-2 h-4 w-4\" /> Vídeo Full\n                </DropdownMenuItem>\n                <DropdownMenuItem\n                  onClick={() => handleAddBlock('video-autoplay')}\n                >\n                  <Video className=\"mr-2 h-4 w-4 text-blue-400\" /> Vídeo\n                  Autoplay (Loop)\n                </DropdownMenuItem>\n\n                <DropdownMenuSeparator className=\"bg-slate-800\" />\n                <DropdownMenuLabel className=\"text-xs uppercase tracking-widest text-slate-500\">\n                  Composições\n                </DropdownMenuLabel>\n\n                <DropdownMenuItem onClick={() => handleAddBlock('image-text')}>\n                  <div className=\"flex mr-2 items-center\">\n                    <ImageIcon className=\"h-3 w-3\" />\n                    <Type className=\"h-3 w-3\" />\n                  </div>{' '}\n                  Imagem + Texto\n                </DropdownMenuItem>\n                <DropdownMenuItem onClick={() => handleAddBlock('text-image')}>\n                  <div className=\"flex mr-2 items-center\">\n                    <Type className=\"h-3 w-3\" />\n                    <ImageIcon className=\"h-3 w-3\" />\n                  </div>{' '}\n                  Texto + Imagem\n                </DropdownMenuItem>\n                <DropdownMenuItem onClick={() => handleAddBlock('image-image')}>\n                  <ColumnsIcon className=\"mr-2 h-4 w-4\" /> Imagem Dupla (Grid)\n                </DropdownMenuItem>\n                <DropdownMenuItem onClick={() => handleAddBlock('image-video')}>\n                  <div className=\"flex mr-2 items-center\">\n                    <ImageIcon className=\"h-3 w-3\" />\n                    <Video className=\"h-3 w-3\" />\n                  </div>{' '}\n                  Imagem + Vídeo\n                </DropdownMenuItem>\n                <DropdownMenuItem onClick={() => handleAddBlock('video-text')}>\n                  <div className=\"flex mr-2 items-center\">\n                    <Video className=\"h-3 w-3\" />\n                    <Type className=\"h-3 w-3\" />\n                  </div>{' '}\n                  Vídeo + Texto\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n\n          {/* Blocks List */}\n          <div className=\"space-y-8 min-h-[500px]\">\n            {sections.length === 0 && (\n              <div className=\"h-64 flex flex-col items-center justify-center border-2 border-dashed border-white/5 rounded-3xl bg-slate-900/20 text-slate-500\">\n                <Layout className=\"mb-4 opacity-20\" size={64} />\n                <p className=\"text-sm\">\n                  Comece adicionando um bloco via menu acima.\n                </p>\n              </div>\n            )}\n\n            {sections.map((section, index) => (\n              <motion.div\n                key={section.id}\n                initial={{ opacity: 0, scale: 0.95 }}\n                animate={{ opacity: 1, scale: 1 }}\n                className=\"group relative bg-[#0a0a0a] border border-white/5 rounded-3xl overflow-hidden hover:border-blue-500/30 transition-all shadow-xl\"\n              >\n                {/* Block Header */}\n                <div className=\"flex items-center justify-between px-6 py-4 bg-white/5 border-b border-white/5\">\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-[10px] font-bold text-blue-400 bg-blue-500/10 px-2 py-1 rounded border border-blue-500/20\">\n                      {(index + 1).toString().padStart(2, '0')}\n                    </span>\n                    <span className=\"text-xs font-bold uppercase tracking-widest text-slate-400\">\n                      {section.type.replace('-', ' & ')}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-1 opacity-50 group-hover:opacity-100 transition-opacity\">\n                    <button\n                      onClick={() => moveSection(index, 'up')}\n                      disabled={index === 0}\n                      className=\"p-2 hover:bg-white/10 rounded-lg disabled:opacity-20\"\n                      title=\"Mover para cima\"\n                      aria-label=\"Mover para cima\"\n                    >\n                      <ChevronUp size={14} />\n                    </button>\n                    <button\n                      onClick={() => moveSection(index, 'down')}\n                      disabled={index === sections.length - 1}\n                      className=\"p-2 hover:bg-white/10 rounded-lg disabled:opacity-20\"\n                      title=\"Mover para baixo\"\n                      aria-label=\"Mover para baixo\"\n                    >\n                      <ChevronDown size={14} />\n                    </button>\n                    <div className=\"w-px h-4 bg-white/10 mx-2\" />\n                    <button\n                      onClick={() => handleRemoveSection(section.id)}\n                      className=\"p-2 hover:bg-red-500/20 hover:text-red-400 rounded-lg text-slate-500\"\n                      title=\"Remover bloco\"\n                      aria-label=\"Remover bloco\"\n                    >\n                      <Trash2 size={14} />\n                    </button>\n                  </div>\n                </div>\n\n                {/* Editor Canvas */}\n                <BlockEditor\n                  block={section}\n                  onChange={(updates) => updateBlock(section.id, updates)}\n                />\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport {\n  Image as ImageIcon,\n  Video,\n  Link as LinkIcon,\n  Trash2,\n} from 'lucide-react';\n\ninterface MediaInputProps {\n  label: string;\n  type: 'image' | 'video';\n  value?: string; // URL or path\n  previewUrl?: string;\n  onFileSelect: (_file: File) => void;\n  onUrlChange: (_url: string) => void;\n  onClear: () => void;\n}\n\nexport function MediaInput({\n  label,\n  type,\n  value,\n  previewUrl,\n  onFileSelect,\n  onUrlChange,\n  onClear,\n}: MediaInputProps) {\n  const [mode, setMode] = useState<'upload' | 'url'>('upload');\n  // Detect if initial value is an external URL to set mode\n  useEffect(() => {\n    if (value && (value.startsWith('http') || value.startsWith('www'))) {\n      // If it's a Supabase storage URL, we might consider it an \"upload\" technically,\n      // but for editing input purposes, if it's text, it's a URL.\n      // However, we usually browse files. Let's keep it simple.\n      // If the user pasted a YouTube link, set to URL mode.\n      if (!value.includes('supabase.co')) {\n        setMode('url');\n      }\n    }\n  }, [value]);\n\n  const getYouTubeId = (url: string) => {\n    const regExp =\n      /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/;\n    const match = url.match(regExp);\n    return match && match[2].length === 11 ? match[2] : null;\n  };\n\n  const youtubeId = mode === 'url' && value ? getYouTubeId(value) : null;\n  const showPreview = !!previewUrl || (!!value && mode === 'url');\n\n  // Helper to determine accurate preview source\n  const displaySrc = previewUrl || value;\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"flex items-center justify-between\">\n        <label className=\"text-xs uppercase tracking-widest text-slate-500 font-medium\">\n          {label}\n        </label>\n        <div className=\"flex bg-slate-800 p-1 rounded-lg\">\n          <button\n            onClick={() => setMode('upload')}\n            className={`px-2 py-1 text-xs rounded-md transition-all ${mode === 'upload' ? 'bg-slate-600 text-white' : 'text-slate-400 hover:text-white'}`}\n          >\n            Upload\n          </button>\n          <button\n            onClick={() => setMode('url')}\n            className={`px-2 py-1 text-xs rounded-md transition-all ${mode === 'url' ? 'bg-slate-600 text-white' : 'text-slate-400 hover:text-white'}`}\n          >\n            Link\n          </button>\n        </div>\n      </div>\n\n      {showPreview ? (\n        <div className=\"relative rounded-xl overflow-hidden border border-white/10 group bg-black/20\">\n          {youtubeId ? (\n            <div className=\"aspect-video w-full bg-black\">\n              <iframe\n                src={`https://www.youtube.com/embed/${youtubeId}?autoplay=0&mute=1&modestbranding=1`}\n                title=\"YouTube preview\"\n                className=\"w-full h-full border-none\"\n                allowFullScreen\n              />\n            </div>\n          ) : type === 'image' ? (\n            <div className=\"relative min-h-[12.5rem] max-h-[25rem] w-full flex justify-center bg-black/40\">\n              {/* eslint-disable-next-line @next/next/no-img-element */}\n              <img\n                src={displaySrc}\n                alt=\"Preview\"\n                className=\"h-full w-auto max-h-[25rem] object-contain\"\n              />\n            </div>\n          ) : (\n            <video\n              src={displaySrc}\n              className=\"w-full max-h-[25rem] object-contain\"\n              controls\n              muted\n              loop\n              autoPlay\n            />\n          )}\n\n          <div className=\"absolute top-2 right-2 flex gap-2\">\n            <button\n              onClick={onClear}\n              className=\"bg-red-500 p-2 rounded-full hover:bg-red-600 transition-colors shadow-lg\"\n              title=\"Remover mídia\"\n            >\n              <Trash2 size={16} />\n            </button>\n          </div>\n        </div>\n      ) : mode === 'upload' ? (\n        <label className=\"flex flex-col items-center justify-center py-12 rounded-xl border-2 border-dashed border-white/10 hover:border-blue-500 hover:bg-blue-500/5 cursor-pointer transition-all group\">\n          {type === 'image' ? (\n            <ImageIcon\n              className=\"text-slate-600 mb-2 group-hover:text-blue-400 transition-colors\"\n              size={32}\n            />\n          ) : (\n            <Video\n              className=\"text-slate-600 mb-2 group-hover:text-blue-400 transition-colors\"\n              size={32}\n            />\n          )}\n          <span className=\"text-xs text-slate-500 font-medium uppercase tracking-widest group-hover:text-blue-300\">\n            Escolher Arquivo\n          </span>\n          <input\n            type=\"file\"\n            accept={type === 'image' ? 'image/*' : 'video/*'}\n            onChange={(e) => {\n              const file = e.target.files?.[0];\n              if (file) onFileSelect(file);\n            }}\n            className=\"hidden\"\n          />\n        </label>\n      ) : (\n        <div className=\"flex items-center gap-2 bg-slate-950 border border-white/10 rounded-xl px-4 py-3 focus-within:border-blue-500 transition-colors\">\n          <LinkIcon className=\"text-slate-500\" size={18} />\n          <input\n            type=\"text\"\n            placeholder={\n              type === 'image'\n                ? 'https://exemplo.com/imagem.jpg'\n                : 'Pinte aqui o link do YouTube ou .mp4'\n            }\n            className=\"bg-transparent border-none outline-none w-full text-sm text-white placeholder-slate-600\"\n            onChange={(e) => onUrlChange(e.target.value)}\n            value={value || ''}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n","import { LandingPageBlock } from '@/types/landing-page';\nimport { MediaInput } from './MediaInput';\nimport { Type } from 'lucide-react';\n\ninterface BlockEditorProps {\n  block: LandingPageBlock;\n  onChange: (_updates: Partial<LandingPageBlock>) => void;\n}\n\nexport function BlockEditor({ block, onChange }: BlockEditorProps) {\n  const updateContent = (updates: Partial<typeof block.content>) => {\n    onChange({ content: { ...block.content, ...updates } });\n  };\n\n  const handleFileSelect = (key: 'file' | 'file2', file: File) => {\n    const previewKey = key === 'file' ? 'previewUrl' : 'previewUrl2';\n    const contentKey = key === 'file' ? 'media' : 'media2';\n\n    onChange({\n      [key]: file,\n      [previewKey]: URL.createObjectURL(file), // Local preview\n      content: { ...block.content, [contentKey]: '' }, // Clear text value to prioritize file\n    });\n  };\n\n  const handleUrlChange = (key: 'media' | 'media2', url: string) => {\n    // Clear file inputs if URL is manually set\n    const fileKey = key === 'media' ? 'file' : 'file2';\n    const previewKey = key === 'media' ? 'previewUrl' : 'previewUrl2';\n\n    onChange({\n      [fileKey]: null,\n      [previewKey]: '',\n      content: { ...block.content, [key]: url },\n    });\n  };\n\n  // Helper to render text input\n  const renderTextInput = (key: 'text' | 'text2', label: string) => {\n    const configKey = key === 'text' ? 'textConfig' : 'textConfig2';\n    // @ts-ignore - Dynamic key access\n    const config = block.content[configKey] || {};\n\n    const updateConfig = (updates: Record<string, string>) => {\n      updateContent({ [configKey]: { ...config, ...updates } });\n    };\n\n    return (\n      <div className=\"flex-1 space-y-4\">\n        <label className=\"text-xs uppercase tracking-widest text-slate-500 font-medium flex items-center gap-2\">\n          <Type size={14} /> {label}\n        </label>\n\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 bg-slate-900/50 p-3 rounded-xl border border-white/5\">\n          <div className=\"space-y-1\">\n            <span className=\"text-[10px] uppercase text-slate-500 block\">\n              Tamanho\n            </span>\n            <select\n              value={config.fontSize || ''}\n              onChange={(e) => updateConfig({ fontSize: e.target.value })}\n              className=\"w-full bg-slate-800 text-[11px] rounded p-1 outline-none border border-white/10 text-white\"\n              title=\"Tamanho do Texto\"\n            >\n              <option value=\"\">Padrão</option>\n              <option value=\"text-xs\">Extra Small</option>\n              <option value=\"text-sm\">Small</option>\n              <option value=\"text-base\">Base</option>\n              <option value=\"text-lg\">Large</option>\n              <option value=\"text-xl\">Extra Large</option>\n              <option value=\"text-2xl\">2XL</option>\n              <option value=\"text-3xl\">3XL</option>\n              <option value=\"text-4xl\">4XL</option>\n              <option value=\"text-5xl\">5XL</option>\n              <option value=\"text-6xl\">6XL</option>\n              <option value=\"text-7xl\">7XL</option>\n              <option value=\"text-8xl\">8XL</option>\n            </select>\n          </div>\n          <div className=\"space-y-1\">\n            <span className=\"text-[10px] uppercase text-slate-500 block\">\n              Peso\n            </span>\n            <select\n              value={config.fontWeight || ''}\n              onChange={(e) => updateConfig({ fontWeight: e.target.value })}\n              className=\"w-full bg-slate-800 text-[11px] rounded p-1 outline-none border border-white/10 text-white\"\n              title=\"Peso da Fonte\"\n            >\n              <option value=\"\">Padrão</option>\n              <option value=\"font-thin\">Thin</option>\n              <option value=\"font-light\">Light</option>\n              <option value=\"font-normal\">Normal</option>\n              <option value=\"font-medium\">Medium</option>\n              <option value=\"font-semibold\">SemiBold</option>\n              <option value=\"font-bold\">Bold</option>\n              <option value=\"font-extrabold\">ExtraBold</option>\n              <option value=\"font-black\">Black</option>\n            </select>\n          </div>\n          <div className=\"space-y-1\">\n            <span className=\"text-[10px] uppercase text-slate-500 block\">\n              Alinhamento\n            </span>\n            <select\n              value={config.textAlign || ''}\n              onChange={(e) => updateConfig({ textAlign: e.target.value })}\n              className=\"w-full bg-slate-800 text-[11px] rounded p-1 outline-none border border-white/10 text-white\"\n              title=\"Alinhamento do Texto\"\n            >\n              <option value=\"\">Padrão</option>\n              <option value=\"text-left\">Esquerda</option>\n              <option value=\"text-center\">Centralizado</option>\n              <option value=\"text-right\">Direita</option>\n              <option value=\"text-justify\">Justificado</option>\n            </select>\n          </div>\n          <div className=\"space-y-1\">\n            <span className=\"text-[10px] uppercase text-slate-500 block\">\n              Cor (Hex)\n            </span>\n            <input\n              type=\"text\"\n              value={config.color || ''}\n              onChange={(e) => updateConfig({ color: e.target.value })}\n              placeholder=\"#FFFFFF\"\n              className=\"w-full bg-slate-800 text-[11px] rounded p-1 outline-none border border-white/10 text-white placeholder-slate-600\"\n            />\n          </div>\n        </div>\n\n        <textarea\n          value={block.content[key] || ''}\n          onChange={(e) => updateContent({ [key]: e.target.value })}\n          className=\"w-full h-full min-h-[200px] bg-slate-950/50 border border-white/10 rounded-xl p-4 outline-none focus:border-blue-500/50 transition-all resize-none font-sans\"\n          placeholder=\"# Título... \\n\\nParágrafo com conteúdo...\"\n        />\n      </div>\n    );\n  };\n\n  // Helper to render media input\n  const renderMediaInput = (\n    mediaKey: 'media' | 'media2',\n    type: 'image' | 'video',\n    fileKey: 'file' | 'file2',\n    previewKey: 'previewUrl' | 'previewUrl2',\n    label: string\n  ) => (\n    <div className=\"flex-1\">\n      <MediaInput\n        label={label}\n        type={type}\n        value={block.content[mediaKey]}\n        previewUrl={block[previewKey]}\n        onFileSelect={(f) => handleFileSelect(fileKey, f)}\n        onUrlChange={(url) => handleUrlChange(mediaKey, url)}\n        onClear={() => {\n          onChange({\n            [fileKey]: null,\n            [previewKey]: '',\n            content: { ...block.content, [mediaKey]: '' },\n          });\n        }}\n      />\n    </div>\n  );\n\n  switch (block.type) {\n    case 'text':\n      return (\n        <div className=\"p-4\">\n          {renderTextInput('text', 'Conteúdo de Texto')}\n        </div>\n      );\n\n    case 'image':\n      return (\n        <div className=\"p-4\">\n          {renderMediaInput(\n            'media',\n            'image',\n            'file',\n            'previewUrl',\n            'Imagem Full'\n          )}\n        </div>\n      );\n\n    case 'video':\n    case 'video-autoplay': // Treat similarly in editor, logic mainly for frontend\n      return (\n        <div className=\"p-4\">\n          {renderMediaInput(\n            'media',\n            'video',\n            'file',\n            'previewUrl',\n            'Vídeo Full'\n          )}\n        </div>\n      );\n\n    case 'image-text':\n      return (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 p-4\">\n          {renderMediaInput(\n            'media',\n            'image',\n            'file',\n            'previewUrl',\n            'Imagem (Esquerda)'\n          )}\n          {renderTextInput('text', 'Texto (Direita)')}\n        </div>\n      );\n\n    case 'text-image':\n      return (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 p-4\">\n          {renderTextInput('text', 'Texto (Esquerda)')}\n          {renderMediaInput(\n            'media',\n            'image',\n            'file',\n            'previewUrl',\n            'Imagem (Direita)'\n          )}\n        </div>\n      );\n\n    case 'image-image':\n      return (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 p-4\">\n          {renderMediaInput(\n            'media',\n            'image',\n            'file',\n            'previewUrl',\n            'Imagem 01'\n          )}\n          {renderMediaInput(\n            'media2',\n            'image',\n            'file2',\n            'previewUrl2',\n            'Imagem 02'\n          )}\n        </div>\n      );\n\n    case 'image-video':\n      return (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 p-4\">\n          {renderMediaInput('media', 'image', 'file', 'previewUrl', 'Imagem')}\n          {renderMediaInput('media2', 'video', 'file2', 'previewUrl2', 'Vídeo')}\n        </div>\n      );\n\n    case 'video-text':\n      return (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 p-4\">\n          {renderMediaInput(\n            'media',\n            'video',\n            'file',\n            'previewUrl',\n            'Vídeo (Esquerda)'\n          )}\n          {renderTextInput('text', 'Texto (Direita)')}\n        </div>\n      );\n\n    default:\n      return <div className=\"p-4 text-red-500\">Tipo de bloco desconhecido</div>;\n  }\n}\n","'use client';\n\nimport * as React from 'react';\nimport * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu';\nimport { Check, ChevronRight, Circle } from 'lucide-react';\n\nimport { cn } from '@/lib/utils';\n\nconst DropdownMenu = DropdownMenuPrimitive.Root;\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group;\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal;\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub;\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean;\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      'flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',\n      inset && 'pl-8',\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n));\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName;\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName;\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n));\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      'relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0',\n      inset && 'pl-8',\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n));\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName;\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n));\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      'px-2 py-1.5 text-sm font-semibold',\n      inset && 'pl-8',\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn('-mx-1 my-1 h-px bg-muted', className)}\n    {...props}\n  />\n));\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn('ml-auto text-xs tracking-widest opacity-60', className)}\n      {...props}\n    />\n  );\n};\nDropdownMenuShortcut.displayName = 'DropdownMenuShortcut';\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n};\n"],"names":[],"mappings":"kDAEA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA"}
module.exports=[89433,a=>{"use strict";var b=a.i(95445);let c=/[^a-z0-9._-]/g;var d=a.i(59944);async function e(a,c,e,f){let g,h,i=(0,b.createClientComponentClient)(),j=f.name.split(".").pop(),k=j?`${e}.${j}`:e,l=(h=(g=c.replace(/\/+$/g,"").replace(/^\/+/g,""))?`${g}`:"")?`${h}/${k}`:k,{data:m,error:n}=await i.storage.from(a).upload(l,f,{cacheControl:"3600",upsert:!0});if(n)throw n;return(0,d.normalizeStoragePath)(m.path,a)}async function f({file:a,key:e,page:f,subPath:g,bucket:h="site-assets"}){let i=(0,b.createClientComponentClient)(),j=function({page:a,key:b,subPath:d,extension:e}){let f=[a&&a.trim().length>0?a.trim():"global"];d&&f.push(d.trim().replace(/^\/+|\/+$/g,""));let g=b.trim().toLowerCase().replace(/\s+/g,"_").replace(c,""),h=e.toLowerCase().replace(/^\.+/,"")||"bin",i=`${g}.${h}`;return`${f.join("/")}/${i}`}({page:f,key:e,subPath:g,extension:a.name.split(".").pop()??"bin"}),{data:k,error:l}=await i.storage.from(h).upload(j,a,{cacheControl:"3600",upsert:!0});if(l)throw l;return(0,d.normalizeStoragePath)(k.path,h)}a.s(["uploadSiteAsset",()=>f,"uploadToBucket",()=>e],89433)},12147,a=>{"use strict";var b=a.i(59465),c=a.i(60788),d=a.i(421),e=a.i(20602),f=a.i(13989),g=a.i(57544),h=a.i(95445),i=a.i(89433);let j=g.z.object({title:g.z.string().min(3),slug:g.z.string().min(3),client_name:g.z.string().min(2),brand_name:g.z.string().optional(),year:g.z.coerce.number().int().optional(),project_type:g.z.string().min(2),short_label:g.z.string().optional(),description:g.z.string().optional(),featured_on_home:g.z.boolean().optional(),featured_on_portfolio:g.z.boolean().optional(),featured_home_order:g.z.coerce.number().int().optional().nullable(),featured_portfolio_order:g.z.coerce.number().int().optional().nullable(),is_published:g.z.boolean().optional(),landing_page_id:g.z.string().optional().nullable(),tags:g.z.array(g.z.string()).optional()});function k({project:a,tags:g,landingPages:k,selectedTagIds:l=[]}){let[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useTransition)(),w=(0,d.useRouter)(),x=(0,f.useForm)({resolver:(0,e.zodResolver)(j),defaultValues:{title:a?.title??"",slug:a?.slug??"",client_name:a?.client_name??"",brand_name:a?.brand_name??"",year:a?.year??void 0,project_type:a?.project_type??"Branding & Identity",short_label:a?.short_label??"",description:a?.description??"",featured_on_home:a?.featured_on_home??!1,featured_on_portfolio:a?.featured_on_portfolio??!1,featured_home_order:a?.featured_home_order??void 0,featured_portfolio_order:a?.featured_portfolio_order??void 0,is_published:a?.is_published??!0,landing_page_id:a?.landing_page_id??"",tags:l}}),y=x.watch("tags")||[];return(0,b.jsxs)("form",{className:"space-y-6",onSubmit:x.handleSubmit(b=>{t(null),v(async()=>{try{let c=(0,h.createClientComponentClient)(),d=a?.thumbnail_path??null,e=a?.hero_image_path??null,f=Array.isArray(a?.gallery)?a?.gallery?.map(a=>({path:a.path})):[];if(m&&(d=await (0,i.uploadToBucket)("portfolio-media",`projects/${b.slug}`,"thumb",m)),o&&(e=await (0,i.uploadToBucket)("portfolio-media",`projects/${b.slug}`,"hero",o)),q.length>0)for(let a of q){let c=await (0,i.uploadToBucket)("portfolio-media",`projects/${b.slug}/gallery`,a.name.replace(/\W+/g,"-"),a);c&&f.push({path:c})}let{tags:g=[],...j}=b;""===j.landing_page_id&&(j.landing_page_id=null);let{data:k,error:l}=await c.from("portfolio_projects").upsert({id:a?.id,...j,gallery:f,thumbnail_path:d,hero_image_path:e},{onConflict:"id"}).select().single();if(l)throw l;if(k?.id){await c.from("portfolio_project_tags").delete().eq("project_id",k.id);let a=g.length>0?g:y;a.length>0&&await c.from("portfolio_project_tags").insert(a.map(a=>({project_id:k.id,tag_id:a})))}w.push("/admin/trabalhos"),w.refresh()}catch(a){t(a instanceof Error?a.message:"Ocorreu um erro desconhecido")}})}),children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Título"}),(0,b.jsx)("input",{className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("title")})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Slug"}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[g.length>0&&(0,b.jsxs)("select",{className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm text-slate-200",defaultValue:"",onChange:a=>{let b=a.target.value;b&&x.setValue("slug",b)},children:[(0,b.jsx)("option",{value:"",children:"Usar slug das tags existentes"}),g.map(a=>(0,b.jsxs)("option",{value:a.slug,children:[a.label," — ",a.slug]},a.id))]}),(0,b.jsx)("input",{className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("slug")})]})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Cliente"}),(0,b.jsx)("input",{className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("client_name")})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Marca"}),(0,b.jsx)("input",{className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("brand_name")})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Ano"}),(0,b.jsx)("input",{type:"number",className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("year")})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Tipo de projeto"}),(0,b.jsxs)("select",{className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("project_type"),children:[(0,b.jsx)("option",{children:"Branding & Identity"}),(0,b.jsx)("option",{children:"Campanhas & Advertising"}),(0,b.jsx)("option",{children:"Web & Digital"}),(0,b.jsx)("option",{children:"Motion & Video"}),(0,b.jsx)("option",{children:"Institucional & Retail"})]})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2 md:col-span-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Short label"}),(0,b.jsx)("input",{className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("short_label")})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2 md:col-span-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Descrição"}),(0,b.jsx)("textarea",{rows:4,className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("description")})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-300",children:[(0,b.jsx)("input",{type:"checkbox",...x.register("featured_on_home")}),"Destaque Home"]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-300",children:[(0,b.jsx)("input",{type:"checkbox",...x.register("featured_on_portfolio")}),"Destaque Portfólio"]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-300",children:[(0,b.jsx)("input",{type:"checkbox",...x.register("is_published")}),"Publicado"]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Ordem Home"}),(0,b.jsx)("input",{type:"number",className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("featured_home_order")})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Ordem Portfólio"}),(0,b.jsx)("input",{type:"number",className:"rounded-md bg-slate-900/60 border border-white/10 px-3 py-2 text-sm",...x.register("featured_portfolio_order")})]})]}),(0,b.jsxs)("div",{className:"p-6 bg-blue-600/5 border border-blue-600/10 rounded-xl space-y-4",children:[(0,b.jsx)("h3",{className:"text-sm font-bold uppercase tracking-widest text-blue-400",children:"Página de Destino (Link Interno)"}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-xs text-slate-400",children:"Selecione uma Landing Page para este trabalho"}),(0,b.jsxs)("select",{className:"rounded-md bg-slate-900 border border-white/10 px-3 py-2 text-sm text-white",...x.register("landing_page_id"),children:[(0,b.jsx)("option",{value:"",children:"Nenhuma (Default)"}),k.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.title," (/",a.slug,")"]},a.id))]}),(0,b.jsx)("p",{className:"text-[10px] text-slate-500 italic",children:"Quando vinculado, o clique no trabalho abrirá a Landing Page customizada em vez de uma visualização padrão."})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Thumbnail"}),(0,b.jsx)("input",{type:"file",accept:"image/*,video/*",onChange:a=>n(a.target.files?.[0]??null)}),a?.thumbnail_path&&(0,b.jsx)("span",{className:"text-xs text-slate-400 break-all",children:a.thumbnail_path})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Hero image"}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>p(a.target.files?.[0]??null)}),a?.hero_image_path&&(0,b.jsx)("span",{className:"text-xs text-slate-400 break-all",children:a.hero_image_path})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Galeria"}),(0,b.jsx)("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:a=>r(Array.from(a.target.files??[]))}),Array.isArray(a?.gallery)&&a.gallery.length>0&&(0,b.jsxs)("span",{className:"text-xs text-slate-400",children:[a.gallery.length," itens já cadastrados"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-300 mb-2",children:"Tags"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-3",children:g.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-200",children:[(0,b.jsx)("input",{type:"checkbox",value:a.id,checked:y.includes(a.id),onChange:a=>{let{checked:b,value:c}=a.target;b?x.setValue("tags",[...y,c]):x.setValue("tags",y.filter(a=>a!==c))}}),a.label]},a.id))})]}),s&&(0,b.jsx)("div",{className:"text-sm text-red-400",children:s}),(0,b.jsx)("button",{type:"submit",className:"inline-flex items-center justify-center rounded-md bg-blue-500 px-4 py-2 text-sm font-semibold text-white shadow transition hover:bg-blue-600 disabled:opacity-50",disabled:u,children:u?"Salvando...":"Salvar projeto"})]})}a.s(["ProjectForm",()=>k])}];

//# sourceMappingURL=src_4e00da2d._.js.map
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8003,e=>{"use strict";var t=e.i(50789),o=e.i(29715),a=e.i(74701),r=e.i(32370),s=e.i(9858),i=e.i(86746),n=e.i(78464),l=e.i(67703),c=e.i(40155);function h({positionRef:e,onMovementUpdate:a}){let r=(0,o.useRef)(null),h=(0,o.useRef)(null),{pointer:m,viewport:p}=(0,n.useThree)(),[u,d]=(0,o.useState)(0),y=(0,o.useRef)(0),f=(0,o.useMemo)(()=>{let e=new s.SphereGeometry(2,40,40),t=e.attributes.position.array;for(let e=0;e<t.length;e+=3)if(t[e+1]<-.2){let o=t[e],a=t[e+2],r=.35*Math.sin(5*o),s=.25*Math.cos(4*a),i=.15*Math.sin((o+a)*3);t[e+1]=-2+(r+s+i)}return e.computeVertexNormals(),e},[]);return(0,i.useFrame)((t,o)=>{if(!h.current||!r.current)return;let i=t.clock.elapsedTime,n=m.x*(p.width/2)*.8,c=m.y*(p.height/2)*.8,u=h.current.position.clone();h.current.position.x+=(n-h.current.position.x)*l.GhostParams.followSpeed,h.current.position.y+=(c-h.current.position.y)*l.GhostParams.followSpeed,e.current.copy(h.current.position);let f=.03*Math.sin(i*l.GhostParams.floatSpeed*1.5),v=.018*Math.cos(i*l.GhostParams.floatSpeed*.7),M=.008*Math.sin(i*l.GhostParams.floatSpeed*2.3);h.current.position.y+=f+v+M;let P=new s.Vector2(n-h.current.position.x,c-h.current.position.y).normalize(),x=.1*l.GhostParams.wobbleAmount;r.current.rotation.z=.95*r.current.rotation.z+-P.x*x*.050000000000000044,r.current.rotation.x=.95*r.current.rotation.x+P.y*x*.050000000000000044,r.current.rotation.y=.05*Math.sin(1.4*i)*l.GhostParams.wobbleAmount;let g=Math.sin(i*l.GhostParams.pulseSpeed)*l.GhostParams.pulseIntensity,G=(1+.025*Math.sin(2.1*i)*l.GhostParams.wobbleAmount+.015*g)*(1+.012*Math.sin(.8*i));r.current.scale.set(G,G,G);let w=.12*Math.sin(.6*i);r.current.material.emissiveIntensity=l.GhostParams.emissiveIntensity+g+w;let S=u.distanceTo(h.current.position);y.current=y.current*l.GhostParams.eyeGlowDecay+S*(1-l.GhostParams.eyeGlowDecay);let j=y.current>l.GhostParams.movementThreshold,b=+!!j,R=j?2*l.GhostParams.eyeGlowResponse:l.GhostParams.eyeGlowResponse;d(e=>e+(b-e)*R),a(j,100*S)}),(0,t.jsxs)("group",{ref:h,children:[(0,t.jsx)("mesh",{ref:r,geometry:f,children:(0,t.jsx)("meshStandardMaterial",{color:l.GhostParams.bodyColor,transparent:!0,opacity:l.GhostParams.ghostOpacity,emissive:l.GhostParams.glowColor,emissiveIntensity:l.GhostParams.emissiveIntensity,roughness:.02,metalness:0,side:s.DoubleSide,alphaTest:.1})}),(0,t.jsx)(c.Eyes,{eyeOpacity:u})]})}let m=`
  varying vec2 vUv;
  varying vec3 vWorldPosition;
  void main() {
    vUv = uv;
    vec4 worldPos = modelMatrix * vec4(position, 1.0);
    vWorldPosition = worldPos.xyz;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
`,p=`
  uniform vec3 ghostPosition;
  uniform float revealRadius;
  uniform float fadeStrength;
  uniform float baseOpacity;
  uniform float revealOpacity;
  uniform float time;
  varying vec2 vUv;
  varying vec3 vWorldPosition;
  
  void main() {
    float dist = distance(vWorldPosition.xy, ghostPosition.xy);
    
    // Pulsing reveal radius
    float dynamicRadius = revealRadius + sin(time * 2.0) * 5.0;
    
    // Create smooth reveal gradient
    float reveal = smoothstep(dynamicRadius * 0.2, dynamicRadius, dist);
    reveal = pow(reveal, fadeStrength);
    
    // Mix between revealed and base opacity
    float opacity = mix(revealOpacity, baseOpacity, reveal);
    
    // EXTREMELY low RGB values to avoid bloom interference
    gl_FragColor = vec4(0.001, 0.001, 0.002, opacity);
  }
`;function u({ghostPosition:e}){let a=(0,o.useRef)(null),r=(0,o.useMemo)(()=>({ghostPosition:{value:new s.Vector3(0,0,0)},revealRadius:{value:l.GhostParams.revealRadius},fadeStrength:{value:l.GhostParams.fadeStrength},baseOpacity:{value:l.GhostParams.baseOpacity},revealOpacity:{value:l.GhostParams.revealOpacity},time:{value:0}}),[]);return(0,i.useFrame)(t=>{a.current&&(a.current.uniforms.time.value=t.clock.elapsedTime,a.current.uniforms.ghostPosition.value.copy(e.current))}),(0,t.jsxs)("mesh",{position:[0,0,-50],renderOrder:-100,children:[(0,t.jsx)("planeGeometry",{args:[300,300]}),(0,t.jsx)("shaderMaterial",{ref:a,vertexShader:m,fragmentShader:p,uniforms:r,transparent:!0,depthWrite:!1})]})}function d({ghostPosition:e,isGhostMoving:a,movementSpeed:r}){let n=(0,o.useRef)(null),c=(0,o.useRef)([]),h=(0,o.useRef)(0),m=(0,o.useMemo)(()=>[new s.SphereGeometry(.05,6,6),new s.TetrahedronGeometry(.04,0),new s.OctahedronGeometry(.045,0)],[]),p=(0,o.useMemo)(()=>new s.MeshBasicMaterial({color:l.GhostParams.particleColor,transparent:!0,opacity:0,alphaTest:.1}),[]);return(0,i.useFrame)(t=>{let o=t.clock.elapsedTime,i=performance.now();if((!l.GhostParams.createParticlesOnlyWhenMoving||a&&r>.5)&&i-h.current>100){let t=Math.min(l.GhostParams.particleCreationRate,5);for(let o=0;o<t&&!(c.current.length>=l.GhostParams.particleCount);o++){let t=m[Math.floor(Math.random()*m.length)],o=new s.Mesh(t,p.clone());o.position.copy(e.current),o.position.z-=.8+.6*Math.random(),o.position.x+=(Math.random()-.5)*3.5,o.position.y+=(Math.random()-.5)*3.5-.8;let a=.6+.7*Math.random();o.scale.set(a,a,a);let r=new s.Color(l.GhostParams.particleColor);r.offsetHSL(.1*Math.random()-.05,0,0),o.material.color=r,o.material.opacity=.9*Math.random(),n.current?.add(o),c.current.push({mesh:o,life:1,decay:.003*Math.random()+l.GhostParams.particleDecayRate,velocity:new s.Vector3((Math.random()-.5)*.012,(Math.random()-.5)*.012-.002,(Math.random()-.5)*.012-.006),rotationSpeed:new s.Euler((Math.random()-.5)*.015,(Math.random()-.5)*.015,(Math.random()-.5)*.015)})}h.current=i}for(let e=c.current.length-1;e>=0;e--){let t=c.current[e];t.life-=t.decay,t.mesh.material.opacity=.85*t.life,t.mesh.position.add(t.velocity);let a=8e-4*Math.cos(1.8*o+t.mesh.position.y);t.mesh.position.x+=a,t.mesh.rotation.x+=t.rotationSpeed.x,t.mesh.rotation.y+=t.rotationSpeed.y,t.mesh.rotation.z+=t.rotationSpeed.z,t.life<=0&&(n.current?.remove(t.mesh),t.mesh.geometry.dispose(),t.mesh.material.dispose(),c.current.splice(e,1))}}),(0,t.jsx)("group",{ref:n})}function y(){let e=(0,o.useRef)(null),a=(0,o.useMemo)(()=>Array(20).fill(0).map(()=>({position:new s.Vector3((Math.random()-.5)*40,(Math.random()-.5)*30,(Math.random()-.5)*20),velocity:new s.Vector3((Math.random()-.5)*l.GhostParams.fireflySpeed,(Math.random()-.5)*l.GhostParams.fireflySpeed,(Math.random()-.5)*l.GhostParams.fireflySpeed),phase:Math.random()*Math.PI*2,pulseSpeed:2+3*Math.random()})),[]);return(0,i.useFrame)(t=>{if(!e.current)return;let o=t.clock.elapsedTime;e.current.children.forEach((e,t)=>{let r=a[t],s=e.children[0],i=e.children[1],n=.4*Math.sin((o+r.phase)*r.pulseSpeed)+.6,c=s.material,h=e.material;c.opacity=.4*l.GhostParams.fireflyGlowIntensity*n,h.opacity=.9*l.GhostParams.fireflyGlowIntensity*n,i.intensity=.8*l.GhostParams.fireflyGlowIntensity*n,r.velocity.x+=(Math.random()-.5)*.001,r.velocity.y+=(Math.random()-.5)*.001,r.velocity.z+=(Math.random()-.5)*.001,r.velocity.clampLength(0,l.GhostParams.fireflySpeed),e.position.add(r.velocity),Math.abs(e.position.x)>30&&(r.velocity.x*=-.5),Math.abs(e.position.y)>20&&(r.velocity.y*=-.5),Math.abs(e.position.z)>15&&(r.velocity.z*=-.5)})}),(0,t.jsx)("group",{ref:e,children:a.map((e,o)=>(0,t.jsxs)("mesh",{position:e.position,children:[(0,t.jsx)("sphereGeometry",{args:[.02,2,2]}),(0,t.jsx)("meshBasicMaterial",{color:"#ffff44",transparent:!0,opacity:.9}),(0,t.jsxs)("mesh",{children:[(0,t.jsx)("sphereGeometry",{args:[.08,8,8]}),(0,t.jsx)("meshBasicMaterial",{color:"#ffff88",transparent:!0,opacity:.4,side:s.BackSide})]}),(0,t.jsx)("pointLight",{color:"#ffff44",distance:3,decay:2,intensity:.8})]},o))})}var f=e.i(26152);function v(){let e=(0,o.useRef)(new s.Vector3(0,0,0)),[i,n]=(0,o.useState)(!1),[c,m]=(0,o.useState)(0);return(0,t.jsx)("div",{className:"fixed inset-0 z-0 pointer-events-none",children:(0,t.jsx)(a.Canvas,{dpr:[1,2],camera:{position:[0,0,20],fov:75},gl:{antialias:!0,alpha:!0,powerPreference:"high-performance",toneMapping:s.ACESFilmicToneMapping,toneMappingExposure:.9},children:(0,t.jsxs)(o.Suspense,{fallback:null,children:[(0,t.jsx)("color",{attach:"background",args:["#000000"]})," ",(0,t.jsx)("ambientLight",{intensity:.08,color:"#0a0a2e"}),(0,t.jsx)("directionalLight",{position:[-8,6,-4],intensity:l.GhostParams.rimLightIntensity,color:"#4a90e2"}),(0,t.jsx)("directionalLight",{position:[8,-4,-6],intensity:.7*l.GhostParams.rimLightIntensity,color:"#50e3c2"}),(0,t.jsx)(h,{positionRef:e,onMovementUpdate:(e,t)=>{n(e),m(t)}}),(0,t.jsx)(u,{ghostPosition:e}),(0,t.jsx)(d,{ghostPosition:e,isGhostMoving:i,movementSpeed:c}),(0,t.jsx)(y,{}),(0,t.jsxs)(r.EffectComposer,{disableNormalPass:!0,children:[(0,t.jsx)(r.Bloom,{luminanceThreshold:0,mipmapBlur:!0,intensity:.3,radius:.5}),(0,t.jsx)(f.AnalogDecayEffect,{})]})]})})})}e.s(["default",()=>v],8003)},12235,e=>{e.n(e.i(8003))}]);
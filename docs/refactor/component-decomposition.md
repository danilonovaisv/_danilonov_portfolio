# Component Decomposition Proposals

> Generated by Code Quality Refactor Workflow  
> Date: 2025-12-29

## Overview

This document identifies components exceeding 250 lines and proposes modular extraction strategies to improve maintainability, testability, and code readability.

---

## 1. `FluidGlass.tsx` (540 lines) — **HIGH PRIORITY**

### Current Structure
```
FluidGlass.tsx
├── Types (lines 20-48)
│   ├── FluidGlassMode
│   ├── FluidGlassProps
│   └── FluidGlassMaterialProps
├── Shader Material (lines ~50-200)
│   └── Custom shader with vertex/fragment
├── GlassBar Component (lines 204-442)
│   └── Heavy WebGL logic
├── Scene Component (lines 444-491)
│   └── R3F scene setup
└── FluidGlass (lines 493-536)
    └── Main export with Canvas
```

### Proposed Decomposition

```
src/components/header/webgl/
├── FluidGlass.tsx          (~80 lines) — Main orchestrator
├── FluidGlassScene.tsx     (~50 lines) — R3F Scene wrapper
├── GlassBar.tsx            (~250 lines) — Glass bar mesh logic
├── FluidGlassMaterial.ts   (~150 lines) — Shader material
└── types.ts                (extend existing) — FluidGlass types
```

### Extraction Steps
1. Move `FluidGlassMaterialProps` and `FluidGlassProps` interfaces to `types.ts`
2. Extract shader material definition to `FluidGlassMaterial.ts`
3. Move `GlassBar` function to `GlassBar.tsx` with proper imports
4. Move `Scene` function to `FluidGlassScene.tsx`
5. Keep main `FluidGlass` component as thin orchestrator

### Benefits
- ✅ Shader code isolated for easier debugging
- ✅ GlassBar can be tested independently
- ✅ Scene setup reusable for other WebGL contexts
- ✅ Reduced cognitive load per file

---

## 2. `MobileStaggeredMenu.tsx` (386 lines) — **MEDIUM PRIORITY**

### Current Structure
```
MobileStaggeredMenu.tsx
├── Constants (lines 12-17)
├── Main Component (lines 19-384)
│   ├── State management (~50 lines)
│   ├── GSAP timeline setup (~80 lines)
│   ├── Event handlers (~30 lines)
│   └── JSX render (~200 lines)
```

### Proposed Decomposition

```
src/components/header/mobile/
├── MobileStaggeredMenu.tsx   (~150 lines) — Main orchestrator
├── MenuOverlay.tsx           (~100 lines) — Gradient overlay layers
├── MenuItems.tsx             (~80 lines) — Nav item rendering
├── useMenuAnimation.ts       (~100 lines) — GSAP timeline hook
└── constants.ts              (~20 lines) — Animation timing constants
```

### Extraction Steps
1. Move animation constants to `constants.ts`
2. Extract GSAP timeline logic to `useMenuAnimation.ts` custom hook
3. Separate overlay rendering (prelayer divs) to `MenuOverlay.tsx`
4. Extract nav item mapping to `MenuItems.tsx`
5. Keep main component for state and orchestration

### Benefits
- ✅ Animation logic reusable across mobile components
- ✅ Menu items styling easier to modify
- ✅ Overlay can be reused for other modal contexts
- ✅ Constants centralized for consistent timing

---

## 3. Components Near Threshold (200-250 lines)

These don't require immediate action but should be monitored:

| Component | Lines | Notes |
|-----------|-------|-------|
| `GlassSVGFilter.tsx` | 242 | Complex SVG filters, could extract filter definitions |
| `GlassSurface.tsx` | 238 | Many variants, could use compound components |
| `ContactForm.tsx` | 225 | Form + success state, could split |

---

## Implementation Notes

### When to Extract
- Extract when:
  - File > 250 lines
  - More than 2 distinct responsibilities
  - Logic could be reused elsewhere
  - Testing requires complex mocking

### When NOT to Extract
- Co-located logic that changes together
- Single-purpose utilities
- Closely coupled render logic

---

## Next Steps

1. [ ] Discuss with team before implementing
2. [ ] Prioritize FluidGlass extraction (most impact)
3. [ ] Create feature branch for decomposition work
4. [ ] Ensure tests pass after each extraction
5. [ ] Update import paths across codebase


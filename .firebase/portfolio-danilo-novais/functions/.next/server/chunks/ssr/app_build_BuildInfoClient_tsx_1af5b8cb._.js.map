{"version":3,"sources":["../../../../app/build/BuildInfoClient.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\n\ntype BuildInfo = {\n  buildTimeISO?: string;\n  gitSha?: string;\n  gitShaShort?: string;\n  nodeEnv?: string;\n};\n\nasync function fetchBuildInfo(): Promise<BuildInfo> {\n  const res = await fetch(`/build-info.json?t=${Date.now()}`, { cache: 'no-store' });\n  if (!res.ok) return {};\n  return (await res.json()) as BuildInfo;\n}\n\nconst formatDate = (value?: string) => {\n  if (!value) return '—';\n  const date = new Date(value);\n  return date.toLocaleString(undefined, {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit',\n  });\n};\n\nexport default function BuildInfoClient() {\n  const [info, setInfo] = React.useState<BuildInfo | null>(null);\n  const [error, setError] = React.useState<string | null>(null);\n\n  React.useEffect(() => {\n    let mounted = true;\n\n    fetchBuildInfo()\n      .then((data) => {\n        if (!mounted) return;\n        setInfo(data);\n      })\n      .catch((err) => {\n        if (!mounted) return;\n        setError(err instanceof Error ? err.message : 'Falha ao carregar build-info.json');\n      });\n\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  return (\n    <section className=\"mx-auto max-w-3xl px-4 py-10\">\n      <h1 className=\"text-2xl font-semibold tracking-tight text-white\">Build / Deploy stamp</h1>\n      <p className=\"mt-2 text-sm leading-relaxed text-white/70\">\n        Esta página confirma objetivamente se o Firebase está servindo o build mais recente\n        (sem depender de cache no browser).\n      </p>\n\n      <div className=\"mt-6 rounded-2xl border border-white/10 bg-white/5 p-5\">\n        {error ? (\n          <div className=\"text-sm text-red-200\">\n            <p className=\"font-medium\">Falha ao carregar build-info.json</p>\n            <p className=\"mt-1 opacity-80\">{error}</p>\n          </div>\n        ) : !info ? (\n          <div className=\"text-sm text-white/70\">Carregando…</div>\n        ) : (\n          <dl className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\n            <div>\n              <dt className=\"text-xs uppercase tracking-widest text-white/50\">buildTime (local)</dt>\n              <dd className=\"mt-1 font-mono text-sm text-white\">{formatDate(info.buildTimeISO)}</dd>\n            </div>\n\n            <div>\n              <dt className=\"text-xs uppercase tracking-widest text-white/50\">buildTime (ISO)</dt>\n              <dd className=\"mt-1 font-mono text-sm text-white\">{info.buildTimeISO ?? '—'}</dd>\n            </div>\n\n            <div className=\"sm:col-span-2\">\n              <dt className=\"text-xs uppercase tracking-widest text-white/50\">git sha</dt>\n              <dd className=\"mt-1 flex flex-wrap items-center gap-2\">\n                <span className=\"font-mono text-sm text-white\">{info.gitSha ?? '—'}</span>\n                {info.gitSha ? (\n                  <button\n                    type=\"button\"\n                    className=\"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-white/80 transition hover:bg-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/30\"\n                    onClick={async () => {\n                      await navigator.clipboard.writeText(info.gitSha ?? '');\n                    }}\n                  >\n                    copiar\n                  </button>\n                ) : null}\n              </dd>\n            </div>\n          </dl>\n        )}\n      </div>\n\n      <div className=\"mt-6 rounded-2xl border border-white/10 bg-white/5 p-5\">\n        <h2 className=\"text-sm font-medium text-white\">Checklist rápido</h2>\n        <ul className=\"mt-3 list-disc space-y-2 pl-5 text-sm text-white/70\">\n          <li>\n            O campo <span className=\"font-mono\">buildTime</span> deve mudar a cada deploy.\n          </li>\n          <li>\n            HTML responde com <span className=\"font-mono\">Cache-Control: max-age=0, must-revalidate</span>.\n          </li>\n          <li>\n            Assets em <span className=\"font-mono\">/_next/static/</span> podem (e devem) ficar em cache longo.\n          </li>\n        </ul>\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":"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"}